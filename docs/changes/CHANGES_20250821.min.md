<!--
Project: shorts-player-kit
File:    docs/CHANGES.min.md
Role:    “ミニCHANGEログ”の**Append-only**版（レビュー/配布向けの要点サマリ）
Depends: docs/CHANGES.md（長文一次情報）, handshake.json（次スレ移行ハンドオフ）
Rules:
  - 1日あたり**箇条書き（目安3–10行）**／**古い日付が上・新しい日付は末尾に追記**
  - 削除・ローテーション・ローリングはしない（**Append-only**）
  - “Updated:” はJSTで手動更新（人が見て直感で最新がわかること）
Quick Append:
  - 末尾に雛形を追加して編集：
    ## YYYY-MM-DD
    - 変更事項（箇条書き）
NS-Core+J One-liner:
  Propose→Justify→Min-Execute→Verify→Record を小さく速く回す。楽しさを推進剤に継続学習。
-->

CHANGES.min (Append-only) — shorts-player-kit

Updated: 2025-08-21 19:10 JST

## 2025-08-19
- 透明化の根因特定：CSS `!important` が JS の直塗りを殺し、var 未解決で `transparent` 落下 → `!important` 撤去
- テーマ層の単純化：A=明薄ベール／B,T=暗ベールを直塗り base の上に重畳、帯は `--symbol-bg-color` 連動
- TTS 粒度フラグ（Tag/TitleKey/Title/Narr）と読上げ正規化（「#Trivia N → トリビア N」）、音声未提供でも擬似ウェイトで同期
- Debug Panel 最小版：開始ボタンの干渉排除、Note 最上段
- ドキュメント運用確立（README/CHANGES/handshake）、NS-Core（Propose/Justify/Min-Execute/Verify/Record）採用

## 2025-08-20
- プロジェクト整理：`2025-08-20_shorts-genesis_d05_v01` → **shorts-player-kit**（台本複数運用に備え安定名へ）
- 背景は **JS 最終決定**（`scene.base` を `#bgColor`＋`body` に直塗り）、CSS はベール層のみ（`!important` 禁止）
- ロード順契約固定：`style.css → debug_panel.js → player.core.js`／`index.html` を堅牢化、iOS用 `scenes.inline.js` シムは任意同梱
- Debug Panel：Play は**現在ページから**、Stop で TTS/エフェクト確実停止、Note=AI_Comment、TTS 4役トグル既定ON
- `schema v2.6.1`：B制約＋ `tts.roleVoiceHints / roleEnableFlags`＋ `meta.nextStep(NS-Core+Joy)`
- `scenes.json` を**第六日**に刷新／デスクトップ＋iOS(Textastic)でE2E動作確認

## 2025-08-21
- **Textastic下端固定を確立**：`env(safe-area-inset-*)` + `visualViewport` 追従で中段固定化を解消／機種条件で **+80px** 実測オフセット
- **Debug Panel拡張**：`Note` 読みトグル（既定OFF）追加／**m4a Export**（現在/全体）ボタン実装・実機成功
- **player.core.js強化**：`collectCurrentText` / `collectAllText` / `runShortcutForText` を追加、`speakScene()` に Note 読上げを統合
- **Shortcuts連携**：既定は `"Make Spoken Audio from Text"`→ `.m4a/.caf` 保存（フォルダ名固定不要）／MP3化は **a-Shell+LAME（実験路線）**
- **UI安定化**：左右切れ解消、Safariでは下端が僅かに上がるが許容範囲／ダブルタップ拡大抑止（`touch-action: manipulation`）
- **手順テンプレ更新**：**ブロックごと置換を優先**し、3Step（ファイル名→検索ワード→相対位置）＋直前/直後行の完全体で指示
- **既知の制約**：Shortcutsは前面遷移（録画同時利用は不可）／Web Speechは録画・演出同期専用に分担